<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE nta PUBLIC '-//Uppaal Team//DTD Flat System 1.1//EN' 'http://www.it.uu.se/research/group/darts/uppaal/flat-1_1.dtd'>
<nta>
	<declaration>// Place global declarations here.
const int SENSORS = 3;

typedef int [0, SENSORS-1]sensor_id;

chan onSensor, offSensor, measurementTaken;
broadcast chan on[sensor_id], off[sensor_id];
chan changeSpeed;
broadcast chan allPlanStepsExecuted, noPlanningNeeded, noAnalysisRequired;
int newSpeed, sensorId;

int uuvSpeed = 21, count[sensor_id], empty[sensor_id], mCount[sensor_id], avgRates[sensor_id], currentAvgRates[sensor_id], sId;


chan monitor, calculate_probability, receive_probability, setAverageMRates, start_analysis, planning, execute;

const int MAX_PLAN = SENSORS + 1;

const int ON_SENSOR = 1, OFF_SENSOR = 2, CHANGE_SPEED = 3;

typedef struct {
int step;
int data;
}PlanStep;

struct{
PlanStep steps[MAX_PLAN];
int stepCount;
}plan;

const int R1 = 20;
const int NUM_OF_SENSORS = 3;
const int NUM_OF_SENSOR_CONFIGS	= 7; //possible sensor configurations
//const int NUM_OF_SPEED_CONFIGS = 50; // [0,50], discrete steps
const int NUM_OF_SPEED_CONFIGS = 21; // [20,40], discrete steps

//Structure that keeps the result after RQV (i.e., expected number of accurate measurements + expected power consumption)
typedef struct{
	bool 	sensors[SENSORS];
	int 	speed;
	int 	req1Result; // expected number of accurate measurements
	int 	req2Result; // expected power consumption
}RQVResult;

RQVResult RQVResultsArray[NUM_OF_SENSOR_CONFIGS * NUM_OF_SPEED_CONFIGS];
RQVResult bestConfiguration;
RQVResult currentConfiguration = {{5,4,4},21,25,43};
//RQVResult EMPTY_CONFIG = {{-1,-1,-1},-1,-1,-1};


</declaration>
	<template>
		<name x="5" y="5">Sensor</name>
		<parameter>sensor_id id</parameter>
		<declaration>// Place local declarations here.
</declaration>
		<location id="id0" x="232" y="-40" color="#ffa500">
			<name x="222" y="-70">Off</name>
		</location>
		<location id="id1" x="16" y="-40" color="#00ff00">
			<name x="6" y="-70">On</name>
		</location>
		<init ref="id1"/>
		<transition>
			<source ref="id0"/>
			<target ref="id1"/>
			<label kind="synchronisation" x="80" y="-16">on[id]?</label>
			<nail x="232" y="8"/>
			<nail x="16" y="8"/>
		</transition>
		<transition>
			<source ref="id1"/>
			<target ref="id0"/>
			<label kind="synchronisation" x="80" y="-64">off[id]?</label>
		</transition>
	</template>
	<template>
		<name>UUV</name>
		<declaration>
void countMeasurements(){
    count[sId] ++;
}</declaration>
		<location id="id2" x="510" y="-34">
			<name x="467" y="-85">SpeedChanged</name>
			<committed/>
		</location>
		<location id="id3" x="306" y="-34">
			<committed/>
		</location>
		<location id="id4" x="102" y="-34">
			<name x="76" y="-85">Running</name>
		</location>
		<init ref="id4"/>
		<transition>
			<source ref="id3"/>
			<target ref="id2"/>
			<label kind="assignment" x="323" y="-59">uuvSpeed = newSpeed</label>
		</transition>
		<transition>
			<source ref="id2"/>
			<target ref="id4"/>
			<nail x="476" y="0"/>
			<nail x="136" y="0"/>
		</transition>
		<transition>
			<source ref="id4"/>
			<target ref="id3"/>
			<label kind="synchronisation" x="153" y="-59">changeSpeed?</label>
		</transition>
	</template>
	<template>
		<name>Probe</name>
		<declaration>clock x;
const int WAIT_TIME = 9;

//445, 541, 245_1, 245_2,144

int  rates[3][6] = {{5, 4,5,2,2,1},{5, 4,4,4,4,4},{2, 5,1,5,5,4}};
//int  rates[3][4] = {{4,5,2,1},{4,4,4,4},{5,1,5,4}};
int turn = 0;
void sendMeasurements(){
   avgRates[0] = rates[0][turn];
	avgRates[1] = rates[1][turn];
	avgRates[2] = rates[2][turn];
    turn = turn &gt;= 5? 0: turn +1 ;
}
</declaration>
		<location id="id5" x="48" y="-40">
			<committed/>
		</location>
		<location id="id6" x="-224" y="-40" color="#00ff00">
			<label kind="invariant" x="-296" y="-72">x &lt;= WAIT_TIME</label>
		</location>
		<init ref="id6"/>
		<transition>
			<source ref="id5"/>
			<target ref="id6"/>
			<label kind="assignment" x="-128" y="8">x=0</label>
			<nail x="24" y="0"/>
			<nail x="-208" y="0"/>
		</transition>
		<transition>
			<source ref="id6"/>
			<target ref="id5"/>
			<label kind="guard" x="-144" y="-96">x &gt;= WAIT_TIME</label>
			<label kind="synchronisation" x="-144" y="-80">setAverageMRates!</label>
			<label kind="assignment" x="-152" y="-64">sendMeasurements()</label>
		</transition>
	</template>
	<template>
		<name>Effector</name>
		<location id="id7" x="-184" y="0">
			<committed/>
		</location>
		<location id="id8" x="168" y="0">
			<committed/>
		</location>
		<location id="id9" x="0" y="0">
		</location>
		<init ref="id9"/>
		<transition>
			<source ref="id7"/>
			<target ref="id9"/>
			<label kind="synchronisation" x="-152" y="16">off[sensorId]!</label>
			<nail x="-184" y="40"/>
			<nail x="-24" y="40"/>
		</transition>
		<transition>
			<source ref="id9"/>
			<target ref="id7"/>
			<label kind="synchronisation" x="-152" y="-72">offSensor?</label>
			<nail x="-32" y="-48"/>
			<nail x="-184" y="-48"/>
		</transition>
		<transition>
			<source ref="id8"/>
			<target ref="id9"/>
			<label kind="synchronisation" x="48" y="16">on[sensorId]!</label>
			<nail x="168" y="40"/>
			<nail x="24" y="40"/>
		</transition>
		<transition>
			<source ref="id9"/>
			<target ref="id8"/>
			<label kind="synchronisation" x="48" y="-72">onSensor?</label>
			<nail x="16" y="-48"/>
			<nail x="168" y="-48"/>
		</transition>
	</template>
	<template>
		<name>Monitor</name>
		<declaration>
bool analysisRequired(){
    return avgRates != currentAvgRates;
}
</declaration>
		<location id="id10" x="-192" y="32">
			<name x="-243" y="-44">StartAnalysis</name>
			<committed/>
		</location>
		<location id="id11" x="-384" y="32">
			<name x="-418" y="-44">PreProcess</name>
			<committed/>
		</location>
		<location id="id12" x="-576" y="32">
			<name x="-601" y="-44">Waiting</name>
		</location>
		<init ref="id12"/>
		<transition>
			<source ref="id10"/>
			<target ref="id12"/>
			<nail x="-192" y="128"/>
			<nail x="-576" y="128"/>
		</transition>
		<transition>
			<source ref="id11"/>
			<target ref="id10"/>
			<label kind="guard" x="-353" y="-10">analysisRequired()</label>
			<label kind="synchronisation" x="-353" y="6">start_analysis!</label>
		</transition>
		<transition>
			<source ref="id11"/>
			<target ref="id12"/>
			<label kind="guard" x="-536" y="56">!analysisRequired()</label>
			<label kind="synchronisation" x="-536" y="72">noAnalysisRequired!</label>
			<nail x="-384" y="96"/>
			<nail x="-544" y="96"/>
		</transition>
		<transition>
			<source ref="id12"/>
			<target ref="id11"/>
			<label kind="synchronisation" x="-548" y="6">setAverageMRates?</label>
		</transition>
	</template>
	<template>
		<name>Analyzer</name>
		<declaration>
const int MIN = -32767;
const int MAX = 32767;

void analyze(){
		int bestConfigurationResult = MAX;
	    	int index = MIN;
	    	int functionResult = MAX;
	    	int sensorConfig;
		    int speedConfig;
	    	for (sensorConfig=0; sensorConfig&lt;NUM_OF_SENSOR_CONFIGS; sensorConfig++){
	    		for (speedConfig=0; speedConfig&lt;NUM_OF_SPEED_CONFIGS; speedConfig++){
	    			// index = sensorConfig*speedConfig;
                    index = (sensorConfig*NUM_OF_SPEED_CONFIGS) + speedConfig;
	    			if (RQVResultsArray[index].req1Result&gt;R1){ // (r1) is satisfied
	    				functionResult = 5 * RQVResultsArray[index].req2Result + 5/RQVResultsArray[index].speed;
					if (avgRates[0]&lt;=2 &amp;&amp; (sensorConfig+1)%2&gt;0) functionResult += 50;
    					if (avgRates[1]&lt;=2 &amp;&amp; (sensorConfig+1)%4&gt;1) functionResult += 50;
    					if (avgRates[2]&lt;=2 &amp;&amp; (sensorConfig+1)%8&gt;3) functionResult += 50;
	    				if (functionResult&lt;bestConfigurationResult){// a new best configuration has been found
	    					bestConfigurationResult = functionResult;
	    					bestConfiguration = RQVResultsArray[index];
	    				}
	    			}
	    		}
	    	}
            currentAvgRates = avgRates;
}

bool adaptationNeeded(){
	return  bestConfiguration.sensors != currentConfiguration.sensors ||
             bestConfiguration.speed != currentConfiguration.speed;
}</declaration>
		<location id="id13" x="-128" y="64">
			<name x="-216" y="16">NoAdaptationNeeded</name>
			<committed/>
		</location>
		<location id="id14" x="-128" y="-64">
			<name x="-192" y="-128">AdaptationNeeded</name>
			<committed/>
		</location>
		<location id="id15" x="-320" y="0">
			<name x="-304" y="-32">CheckAdaptation</name>
			<committed/>
		</location>
		<location id="id16" x="-320" y="128">
			<name x="-384" y="80">CaculateProbability</name>
			<urgent/>
		</location>
		<location id="id17" x="-128" y="128">
			<name x="-160" y="88">StartAnalysis</name>
			<committed/>
		</location>
		<location id="id18" x="64" y="0" color="#00ff00">
			<name x="48" y="-128">Wait</name>
		</location>
		<location id="id19" x="-416" y="0">
			<name x="-456" y="-128">Analyzing</name>
			<committed/>
		</location>
		<init ref="id18"/>
		<transition>
			<source ref="id13"/>
			<target ref="id18"/>
			<label kind="synchronisation" x="-96" y="40">noPlanningNeeded!</label>
			<nail x="64" y="64"/>
		</transition>
		<transition>
			<source ref="id14"/>
			<target ref="id18"/>
			<label kind="synchronisation" x="-96" y="-88">planning!</label>
			<nail x="64" y="-64"/>
		</transition>
		<transition>
			<source ref="id15"/>
			<target ref="id13"/>
			<label kind="guard" x="-304" y="40">!adaptationNeeded()</label>
			<nail x="-320" y="64"/>
		</transition>
		<transition>
			<source ref="id15"/>
			<target ref="id14"/>
			<label kind="guard" x="-304" y="-96">adaptationNeeded()</label>
			<nail x="-320" y="-64"/>
		</transition>
		<transition>
			<source ref="id19"/>
			<target ref="id15"/>
			<label kind="assignment" x="-400" y="-32">analyze()</label>
		</transition>
		<transition>
			<source ref="id16"/>
			<target ref="id19"/>
			<label kind="synchronisation" x="-464" y="104">receive_probability?</label>
			<nail x="-480" y="128"/>
			<nail x="-480" y="0"/>
		</transition>
		<transition>
			<source ref="id17"/>
			<target ref="id16"/>
			<label kind="synchronisation" x="-288" y="104">calculate_probability!</label>
		</transition>
		<transition>
			<source ref="id18"/>
			<target ref="id17"/>
			<label kind="synchronisation" x="-96" y="104">start_analysis?</label>
			<nail x="152" y="0"/>
			<nail x="152" y="128"/>
		</transition>
	</template>
	<template>
		<name>RQV</name>
		<declaration>
RQVResult test445[NUM_OF_SENSOR_CONFIGS * NUM_OF_SPEED_CONFIGS] = {
{{1,0,0},20,23,71},
{{1,0,0},21,22,67},
{{1,0,0},22,21,64},
{{1,0,0},23,20,62},
{{1,0,0},24,19,59},
{{1,0,0},25,19,57},
{{1,0,0},26,18,54},
{{1,0,0},27,17,52},
{{1,0,0},28,17,51},
{{1,0,0},29,16,49},
{{1,0,0},30,16,47},
{{1,0,0},31,15,46},
{{1,0,0},32,15,44},
{{1,0,0},33,14,43},
{{1,0,0},34,14,42},
{{1,0,0},35,13,40},
{{1,0,0},36,13,39},
{{1,0,0},37,13,38},
{{1,0,0},38,12,37},
{{1,0,0},39,12,36},
{{1,0,0},40,12,35},
{{0,1,0},20,19,50},
{{0,1,0},21,18,48},
{{0,1,0},22,17,47},
{{0,1,0},23,16,45},
{{0,1,0},24,16,44},
{{0,1,0},25,15,43},
{{0,1,0},26,14,41},
{{0,1,0},27,14,40},
{{0,1,0},28,13,39},
{{0,1,0},29,13,38},
{{0,1,0},30,12,37},
{{0,1,0},31,11,37},
{{0,1,0},32,11,36},
{{0,1,0},33,10,35},
{{0,1,0},34,10,34},
{{0,1,0},35,9,34},
{{0,1,0},36,9,33},
{{0,1,0},37,9,33},
{{0,1,0},38,9,32},
{{0,1,0},39,8,32},
{{0,1,0},40,8,31},
{{1,1,0},20,42,119},
{{1,1,0},21,40,114},
{{1,1,0},22,38,109},
{{1,1,0},23,37,105},
{{1,1,0},24,35,101},
{{1,1,0},25,34,97},
{{1,1,0},26,32,94},
{{1,1,0},27,31,91},
{{1,1,0},28,30,88},
{{1,1,0},29,29,85},
{{1,1,0},30,28,83},
{{1,1,0},31,26,80},
{{1,1,0},32,25,78},
{{1,1,0},33,24,76},
{{1,1,0},34,24,74},
{{1,1,0},35,23,72},
{{1,1,0},36,22,71},
{{1,1,0},37,21,69},
{{1,1,0},38,21,67},
{{1,1,0},39,20,66},
{{1,1,0},40,20,64},
{{0,0,1},20,19,26},
{{0,0,1},21,18,25},
{{0,0,1},22,17,24},
{{0,0,1},23,16,24},
{{0,0,1},24,15,23},
{{0,0,1},25,15,22},
{{0,0,1},26,12,22},
{{0,0,1},27,12,21},
{{0,0,1},28,11,21},
{{0,0,1},29,11,20},
{{0,0,1},30,10,20},
{{0,0,1},31,10,19},
{{0,0,1},32,10,19},
{{0,0,1},33,9,19},
{{0,0,1},34,9,18},
{{0,0,1},35,9,18},
{{0,0,1},36,8,18},
{{0,0,1},37,8,17},
{{0,0,1},38,8,17},
{{0,0,1},39,7,17},
{{0,0,1},40,7,17},
{{1,0,1},20,42,95},
{{1,0,1},21,40,91},
{{1,0,1},22,38,87},
{{1,0,1},23,36,83},
{{1,0,1},24,35,80},
{{1,0,1},25,34,77},
{{1,0,1},26,30,74},
{{1,0,1},27,29,72},
{{1,0,1},28,28,69},
{{1,0,1},29,27,67},
{{1,0,1},30,26,65},
{{1,0,1},31,25,63},
{{1,0,1},32,24,61},
{{1,0,1},33,23,59},
{{1,0,1},34,23,58},
{{1,0,1},35,22,56},
{{1,0,1},36,21,55},
{{1,0,1},37,21,54},
{{1,0,1},38,20,52},
{{1,0,1},39,19,51},
{{1,0,1},40,19,50},
{{0,1,1},20,37,74},
{{0,1,1},21,36,72},
{{0,1,1},22,34,69},
{{0,1,1},23,32,67},
{{0,1,1},24,31,65},
{{0,1,1},25,30,63},
{{0,1,1},26,27,61},
{{0,1,1},27,26,59},
{{0,1,1},28,25,58},
{{0,1,1},29,24,56},
{{0,1,1},30,23,55},
{{0,1,1},31,21,54},
{{0,1,1},32,20,53},
{{0,1,1},33,19,52},
{{0,1,1},34,19,51},
{{0,1,1},35,18,50},
{{0,1,1},36,17,49},
{{0,1,1},37,17,48},
{{0,1,1},38,16,47},
{{0,1,1},39,16,46},
{{0,1,1},40,15,46},
{{1,1,1},20,61,143},
{{1,1,1},21,58,137},
{{1,1,1},22,55,131},
{{1,1,1},23,53,126},
{{1,1,1},24,51,122},
{{1,1,1},25,48,117},
{{1,1,1},26,45,113},
{{1,1,1},27,43,110},
{{1,1,1},28,41,106},
{{1,1,1},29,40,103},
{{1,1,1},30,38,100},
{{1,1,1},31,36,98},
{{1,1,1},32,35,95},
{{1,1,1},33,34,93},
{{1,1,1},34,32,90},
{{1,1,1},35,31,88},
{{1,1,1},36,30,86},
{{1,1,1},37,29,84},
{{1,1,1},38,29,82},
{{1,1,1},39,28,81},
{{1,1,1},40,27,79}
};


RQVResult test245_1[NUM_OF_SENSOR_CONFIGS * NUM_OF_SPEED_CONFIGS] = {
{{1,0,0},20,23,71},
{{1,0,0},21,22,67},
{{1,0,0},22,21,64},
{{1,0,0},23,20,62},
{{1,0,0},24,19,59},
{{1,0,0},25,19,57},
{{1,0,0},26,18,54},
{{1,0,0},27,17,52},
{{1,0,0},28,17,51},
{{1,0,0},29,16,49},
{{1,0,0},30,16,47},
{{1,0,0},31,15,46},
{{1,0,0},32,15,44},
{{1,0,0},33,14,43},
{{1,0,0},34,14,42},
{{1,0,0},35,13,40},
{{1,0,0},36,13,39},
{{1,0,0},37,13,38},
{{1,0,0},38,12,37},
{{1,0,0},39,12,36},
{{1,0,0},40,12,35},
{{0,1,0},20,19,50},
{{0,1,0},21,18,48},
{{0,1,0},22,17,47},
{{0,1,0},23,16,45},
{{0,1,0},24,16,44},
{{0,1,0},25,15,43},
{{0,1,0},26,14,41},
{{0,1,0},27,14,40},
{{0,1,0},28,13,39},
{{0,1,0},29,13,38},
{{0,1,0},30,12,37},
{{0,1,0},31,11,37},
{{0,1,0},32,11,36},
{{0,1,0},33,10,35},
{{0,1,0},34,10,34},
{{0,1,0},35,9,34},
{{0,1,0},36,9,33},
{{0,1,0},37,9,33},
{{0,1,0},38,9,32},
{{0,1,0},39,8,32},
{{0,1,0},40,8,31},
{{1,1,0},20,42,119},
{{1,1,0},21,40,114},
{{1,1,0},22,38,109},
{{1,1,0},23,37,105},
{{1,1,0},24,35,101},
{{1,1,0},25,34,97},
{{1,1,0},26,32,94},
{{1,1,0},27,31,91},
{{1,1,0},28,30,88},
{{1,1,0},29,29,85},
{{1,1,0},30,28,83},
{{1,1,0},31,26,80},
{{1,1,0},32,25,78},
{{1,1,0},33,24,76},
{{1,1,0},34,24,74},
{{1,1,0},35,23,72},
{{1,1,0},36,22,71},
{{1,1,0},37,21,69},
{{1,1,0},38,21,67},
{{1,1,0},39,20,66},
{{1,1,0},40,20,64},
{{0,0,1},20,10,17},
{{0,0,1},21,9,16},
{{0,0,1},22,9,16},
{{0,0,1},23,8,15},
{{0,0,1},24,8,15},
{{0,0,1},25,8,15},
{{0,0,1},26,6,15},
{{0,0,1},27,6,14},
{{0,0,1},28,6,14},
{{0,0,1},29,6,14},
{{0,0,1},30,5,14},
{{0,0,1},31,5,13},
{{0,0,1},32,5,13},
{{0,0,1},33,5,13},
{{0,0,1},34,5,13},
{{0,0,1},35,4,13},
{{0,0,1},36,4,12},
{{0,0,1},37,4,12},
{{0,0,1},38,4,12},
{{0,0,1},39,4,12},
{{0,0,1},40,4,12},
{{1,0,1},20,33,86},
{{1,0,1},21,31,82},
{{1,0,1},22,30,78},
{{1,0,1},23,29,75},
{{1,0,1},24,27,72},
{{1,0,1},25,26,69},
{{1,0,1},26,24,67},
{{1,0,1},27,23,65},
{{1,0,1},28,22,63},
{{1,0,1},29,22,61},
{{1,0,1},30,21,59},
{{1,0,1},31,20,57},
{{1,0,1},32,19,55},
{{1,0,1},33,19,54},
{{1,0,1},34,18,52},
{{1,0,1},35,18,51},
{{1,0,1},36,17,50},
{{1,0,1},37,17,49},
{{1,0,1},38,16,47},
{{1,0,1},39,16,46},
{{1,0,1},40,15,45},
{{0,1,1},20,28,65},
{{0,1,1},21,27,63},
{{0,1,1},22,26,61},
{{0,1,1},23,25,59},
{{0,1,1},24,24,57},
{{0,1,1},25,23,55},
{{0,1,1},26,21,54},
{{0,1,1},27,20,53},
{{0,1,1},28,19,51},
{{0,1,1},29,18,50},
{{0,1,1},30,18,49},
{{0,1,1},31,16,48},
{{0,1,1},32,15,47},
{{0,1,1},33,15,46},
{{0,1,1},34,14,45},
{{0,1,1},35,14,44},
{{0,1,1},36,13,44},
{{0,1,1},37,13,43},
{{0,1,1},38,12,42},
{{0,1,1},39,12,42},
{{0,1,1},40,12,41},
{{1,1,1},20,52,134},
{{1,1,1},21,49,128},
{{1,1,1},22,47,123},
{{1,1,1},23,45,118},
{{1,1,1},24,43,114},
{{1,1,1},25,41,110},
{{1,1,1},26,39,106},
{{1,1,1},27,37,103},
{{1,1,1},28,36,100},
{{1,1,1},29,34,97},
{{1,1,1},30,33,94},
{{1,1,1},31,31,92},
{{1,1,1},32,30,89},
{{1,1,1},33,29,87},
{{1,1,1},34,28,85},
{{1,1,1},35,27,83},
{{1,1,1},36,26,81},
{{1,1,1},37,25,79},
{{1,1,1},38,25,77},
{{1,1,1},39,24,76},
{{1,1,1},40,23,74}
};


RQVResult test245_2[NUM_OF_SENSOR_CONFIGS * NUM_OF_SPEED_CONFIGS] = {
{{1,0,0},20,23,71},
{{1,0,0},21,22,67},
{{1,0,0},22,21,64},
{{1,0,0},23,20,62},
{{1,0,0},24,19,59},
{{1,0,0},25,19,57},
{{1,0,0},26,18,54},
{{1,0,0},27,17,52},
{{1,0,0},28,17,51},
{{1,0,0},29,16,49},
{{1,0,0},30,16,47},
{{1,0,0},31,15,46},
{{1,0,0},32,15,44},
{{1,0,0},33,14,43},
{{1,0,0},34,14,42},
{{1,0,0},35,13,40},
{{1,0,0},36,13,39},
{{1,0,0},37,13,38},
{{1,0,0},38,12,37},
{{1,0,0},39,12,36},
{{1,0,0},40,12,35},
{{0,1,0},20,19,50},
{{0,1,0},21,18,48},
{{0,1,0},22,17,47},
{{0,1,0},23,16,45},
{{0,1,0},24,16,44},
{{0,1,0},25,15,43},
{{0,1,0},26,14,41},
{{0,1,0},27,14,40},
{{0,1,0},28,13,39},
{{0,1,0},29,13,38},
{{0,1,0},30,12,37},
{{0,1,0},31,11,37},
{{0,1,0},32,11,36},
{{0,1,0},33,10,35},
{{0,1,0},34,10,34},
{{0,1,0},35,9,34},
{{0,1,0},36,9,33},
{{0,1,0},37,9,33},
{{0,1,0},38,9,32},
{{0,1,0},39,8,32},
{{0,1,0},40,8,31},
{{1,1,0},20,42,119},
{{1,1,0},21,40,114},
{{1,1,0},22,38,109},
{{1,1,0},23,37,105},
{{1,1,0},24,35,101},
{{1,1,0},25,34,97},
{{1,1,0},26,32,94},
{{1,1,0},27,31,91},
{{1,1,0},28,30,88},
{{1,1,0},29,29,85},
{{1,1,0},30,28,83},
{{1,1,0},31,26,80},
{{1,1,0},32,25,78},
{{1,1,0},33,24,76},
{{1,1,0},34,24,74},
{{1,1,0},35,23,72},
{{1,1,0},36,22,71},
{{1,1,0},37,21,69},
{{1,1,0},38,21,67},
{{1,1,0},39,20,66},
{{1,1,0},40,20,64},
{{0,0,1},20,10,17},
{{0,0,1},21,9,16},
{{0,0,1},22,9,16},
{{0,0,1},23,8,15},
{{0,0,1},24,8,15},
{{0,0,1},25,8,15},
{{0,0,1},26,6,15},
{{0,0,1},27,6,14},
{{0,0,1},28,6,14},
{{0,0,1},29,6,14},
{{0,0,1},30,5,14},
{{0,0,1},31,5,13},
{{0,0,1},32,5,13},
{{0,0,1},33,5,13},
{{0,0,1},34,5,13},
{{0,0,1},35,4,13},
{{0,0,1},36,4,12},
{{0,0,1},37,4,12},
{{0,0,1},38,4,12},
{{0,0,1},39,4,12},
{{0,0,1},40,4,12},
{{1,0,1},20,33,86},
{{1,0,1},21,31,82},
{{1,0,1},22,30,78},
{{1,0,1},23,29,75},
{{1,0,1},24,27,72},
{{1,0,1},25,26,69},
{{1,0,1},26,24,67},
{{1,0,1},27,23,65},
{{1,0,1},28,22,63},
{{1,0,1},29,22,61},
{{1,0,1},30,21,59},
{{1,0,1},31,20,57},
{{1,0,1},32,19,55},
{{1,0,1},33,19,54},
{{1,0,1},34,18,52},
{{1,0,1},35,18,51},
{{1,0,1},36,17,50},
{{1,0,1},37,17,49},
{{1,0,1},38,16,47},
{{1,0,1},39,16,46},
{{1,0,1},40,15,45},
{{0,1,1},20,28,65},
{{0,1,1},21,27,63},
{{0,1,1},22,26,61},
{{0,1,1},23,25,59},
{{0,1,1},24,24,57},
{{0,1,1},25,23,55},
{{0,1,1},26,21,54},
{{0,1,1},27,20,53},
{{0,1,1},28,19,51},
{{0,1,1},29,18,50},
{{0,1,1},30,18,49},
{{0,1,1},31,16,48},
{{0,1,1},32,15,47},
{{0,1,1},33,15,46},
{{0,1,1},34,14,45},
{{0,1,1},35,14,44},
{{0,1,1},36,13,44},
{{0,1,1},37,13,43},
{{0,1,1},38,12,42},
{{0,1,1},39,12,42},
{{0,1,1},40,12,41},
{{1,1,1},20,52,134},
{{1,1,1},21,49,128},
{{1,1,1},22,47,123},
{{1,1,1},23,45,118},
{{1,1,1},24,43,114},
{{1,1,1},25,41,110},
{{1,1,1},26,39,106},
{{1,1,1},27,37,103},
{{1,1,1},28,36,100},
{{1,1,1},29,34,97},
{{1,1,1},30,33,94},
{{1,1,1},31,31,92},
{{1,1,1},32,30,89},
{{1,1,1},33,29,87},
{{1,1,1},34,28,85},
{{1,1,1},35,27,83},
{{1,1,1},36,26,81},
{{1,1,1},37,25,79},
{{1,1,1},38,25,77},
{{1,1,1},39,24,76},
{{1,1,1},40,23,74}
};

RQVResult test144[NUM_OF_SENSOR_CONFIGS * NUM_OF_SPEED_CONFIGS] = {
{{1,0,0},20,19,57},
{{1,0,0},21,18,55},
{{1,0,0},22,17,52},
{{1,0,0},23,16,50},
{{1,0,0},24,16,48},
{{1,0,0},25,15,46},
{{1,0,0},26,15,44},
{{1,0,0},27,14,42},
{{1,0,0},28,13,41},
{{1,0,0},29,13,39},
{{1,0,0},30,13,38},
{{1,0,0},31,12,37},
{{1,0,0},32,12,36},
{{1,0,0},33,11,35},
{{1,0,0},34,11,34},
{{1,0,0},35,11,33},
{{1,0,0},36,10,32},
{{1,0,0},37,10,31},
{{1,0,0},38,10,30},
{{1,0,0},39,10,29},
{{1,0,0},40,9,29},
{{0,1,0},20,19,50},
{{0,1,0},21,18,48},
{{0,1,0},22,17,47},
{{0,1,0},23,16,45},
{{0,1,0},24,16,44},
{{0,1,0},25,15,43},
{{0,1,0},26,14,41},
{{0,1,0},27,14,40},
{{0,1,0},28,13,39},
{{0,1,0},29,13,38},
{{0,1,0},30,12,37},
{{0,1,0},31,11,37},
{{0,1,0},32,11,36},
{{0,1,0},33,10,35},
{{0,1,0},34,10,34},
{{0,1,0},35,9,34},
{{0,1,0},36,9,33},
{{0,1,0},37,9,33},
{{0,1,0},38,9,32},
{{0,1,0},39,8,32},
{{0,1,0},40,8,31},
{{1,1,0},20,38,105},
{{1,1,0},21,36,101},
{{1,1,0},22,34,97},
{{1,1,0},23,33,93},
{{1,1,0},24,31,90},
{{1,1,0},25,30,86},
{{1,1,0},26,29,83},
{{1,1,0},27,28,81},
{{1,1,0},28,27,78},
{{1,1,0},29,26,76},
{{1,1,0},30,25,74},
{{1,1,0},31,23,72},
{{1,1,0},32,22,70},
{{1,1,0},33,22,68},
{{1,1,0},34,21,66},
{{1,1,0},35,20,65},
{{1,1,0},36,20,63},
{{1,1,0},37,19,62},
{{1,1,0},38,18,60},
{{1,1,0},39,18,59},
{{1,1,0},40,17,58},
{{0,0,1},20,5,12},
{{0,0,1},21,5,12},
{{0,0,1},22,4,11},
{{0,0,1},23,4,11},
{{0,0,1},24,4,11},
{{0,0,1},25,4,11},
{{0,0,1},26,3,11},
{{0,0,1},27,3,11},
{{0,0,1},28,3,11},
{{0,0,1},29,3,10},
{{0,0,1},30,3,10},
{{0,0,1},31,3,10},
{{0,0,1},32,2,10},
{{0,0,1},33,2,10},
{{0,0,1},34,2,10},
{{0,0,1},35,2,10},
{{0,0,1},36,2,10},
{{0,0,1},37,2,10},
{{0,0,1},38,2,10},
{{0,0,1},39,2,10},
{{0,0,1},40,2,9},
{{1,0,1},20,24,67},
{{1,0,1},21,23,64},
{{1,0,1},22,22,62},
{{1,0,1},23,21,59},
{{1,0,1},24,20,57},
{{1,0,1},25,19,55},
{{1,0,1},26,18,53},
{{1,0,1},27,17,51},
{{1,0,1},28,16,49},
{{1,0,1},29,16,48},
{{1,0,1},30,15,46},
{{1,0,1},31,15,45},
{{1,0,1},32,14,44},
{{1,0,1},33,14,43},
{{1,0,1},34,13,42},
{{1,0,1},35,13,41},
{{1,0,1},36,13,40},
{{1,0,1},37,12,39},
{{1,0,1},38,12,38},
{{1,0,1},39,12,37},
{{1,0,1},40,11,36},
{{0,1,1},20,24,60},
{{0,1,1},21,22,58},
{{0,1,1},22,21,56},
{{0,1,1},23,20,54},
{{0,1,1},24,20,53},
{{0,1,1},25,19,51},
{{0,1,1},26,18,50},
{{0,1,1},27,17,49},
{{0,1,1},28,16,48},
{{0,1,1},29,16,47},
{{0,1,1},30,15,46},
{{0,1,1},31,14,45},
{{0,1,1},32,13,44},
{{0,1,1},33,13,43},
{{0,1,1},34,12,42},
{{0,1,1},35,12,42},
{{0,1,1},36,11,41},
{{0,1,1},37,11,40},
{{0,1,1},38,11,40},
{{0,1,1},39,10,39},
{{0,1,1},40,10,39},
{{1,1,1},20,43,115},
{{1,1,1},21,40,111},
{{1,1,1},22,39,106},
{{1,1,1},23,37,102},
{{1,1,1},24,35,99},
{{1,1,1},25,34,95},
{{1,1,1},26,32,92},
{{1,1,1},27,31,89},
{{1,1,1},28,30,87},
{{1,1,1},29,29,84},
{{1,1,1},30,28,82},
{{1,1,1},31,26,80},
{{1,1,1},32,25,78},
{{1,1,1},33,24,76},
{{1,1,1},34,23,74},
{{1,1,1},35,22,72},
{{1,1,1},36,22,71},
{{1,1,1},37,21,69},
{{1,1,1},38,20,68},
{{1,1,1},39,20,66},
{{1,1,1},40,19,65}
};

RQVResult test541[NUM_OF_SENSOR_CONFIGS * NUM_OF_SPEED_CONFIGS] = {
{{1,0,0},20,5,16},
{{1,0,0},21,5,15},
{{1,0,0},22,4,14},
{{1,0,0},23,4,14},
{{1,0,0},24,4,13},
{{1,0,0},25,4,13},
{{1,0,0},26,4,12},
{{1,0,0},27,4,12},
{{1,0,0},28,3,12},
{{1,0,0},29,3,11},
{{1,0,0},30,3,11},
{{1,0,0},31,3,11},
{{1,0,0},32,3,10},
{{1,0,0},33,3,10},
{{1,0,0},34,3,10},
{{1,0,0},35,3,9},
{{1,0,0},36,3,9},
{{1,0,0},37,3,9},
{{1,0,0},38,3,9},
{{1,0,0},39,3,9},
{{1,0,0},40,2,8},
{{0,1,0},20,19,51},
{{0,1,0},21,18,49},
{{0,1,0},22,17,48},
{{0,1,0},23,16,46},
{{0,1,0},24,16,45},
{{0,1,0},25,15,44},
{{0,1,0},26,14,42},
{{0,1,0},27,14,41},
{{0,1,0},28,13,40},
{{0,1,0},29,13,39},
{{0,1,0},30,12,38},
{{0,1,0},31,11,38},
{{0,1,0},32,11,37},
{{0,1,0},33,10,36},
{{0,1,0},34,10,35},
{{0,1,0},35,9,35},
{{0,1,0},36,9,34},
{{0,1,0},37,9,34},
{{0,1,0},38,9,33},
{{0,1,0},39,8,33},
{{0,1,0},40,8,32},
{{1,1,0},20,24,64},
{{1,1,0},21,23,61},
{{1,1,0},22,21,59},
{{1,1,0},23,21,57},
{{1,1,0},24,20,55},
{{1,1,0},25,19,53},
{{1,1,0},26,18,52},
{{1,1,0},27,17,50},
{{1,1,0},28,17,49},
{{1,1,0},29,16,48},
{{1,1,0},30,16,46},
{{1,1,0},31,14,45},
{{1,1,0},32,14,44},
{{1,1,0},33,13,43},
{{1,1,0},34,13,42},
{{1,1,0},35,12,41},
{{1,1,0},36,12,40},
{{1,1,0},37,11,40},
{{1,1,0},38,11,39},
{{1,1,0},39,11,38},
{{1,1,0},40,10,37},
{{0,0,1},20,23,26},
{{0,0,1},21,22,24},
{{0,0,1},22,21,23},
{{0,0,1},23,20,23},
{{0,0,1},24,19,22},
{{0,0,1},25,18,21},
{{0,0,1},26,15,20},
{{0,0,1},27,15,19},
{{0,0,1},28,14,19},
{{0,0,1},29,13,18},
{{0,0,1},30,13,18},
{{0,0,1},31,12,17},
{{0,0,1},32,12,17},
{{0,0,1},33,11,16},
{{0,0,1},34,11,16},
{{0,0,1},35,11,15},
{{0,0,1},36,10,15},
{{0,0,1},37,10,15},
{{0,0,1},38,10,14},
{{0,0,1},39,9,14},
{{0,0,1},40,9,14},
{{1,0,1},20,28,38},
{{1,0,1},21,27,37},
{{1,0,1},22,25,35},
{{1,0,1},23,24,33},
{{1,0,1},24,23,32},
{{1,0,1},25,22,31},
{{1,0,1},26,19,30},
{{1,0,1},27,18,28},
{{1,0,1},28,17,27},
{{1,0,1},29,17,26},
{{1,0,1},30,16,26},
{{1,0,1},31,15,25},
{{1,0,1},32,15,24},
{{1,0,1},33,14,23},
{{1,0,1},34,14,23},
{{1,0,1},35,13,22},
{{1,0,1},36,13,21},
{{1,0,1},37,13,21},
{{1,0,1},38,12,20},
{{1,0,1},39,12,20},
{{1,0,1},40,11,19},
{{0,1,1},20,42,74},
{{0,1,1},21,40,71},
{{0,1,1},22,38,68},
{{0,1,1},23,36,66},
{{0,1,1},24,35,63},
{{0,1,1},25,33,61},
{{0,1,1},26,30,59},
{{0,1,1},27,28,58},
{{0,1,1},28,27,56},
{{0,1,1},29,26,55},
{{0,1,1},30,25,53},
{{0,1,1},31,23,52},
{{0,1,1},32,22,51},
{{0,1,1},33,22,49},
{{0,1,1},34,21,48},
{{0,1,1},35,20,47},
{{0,1,1},36,19,46},
{{0,1,1},37,19,45},
{{0,1,1},38,18,44},
{{0,1,1},39,17,44},
{{0,1,1},40,17,43},
{{1,1,1},20,47,87},
{{1,1,1},21,44,83},
{{1,1,1},22,42,80},
{{1,1,1},23,41,77},
{{1,1,1},24,39,74},
{{1,1,1},25,37,71},
{{1,1,1},26,33,69},
{{1,1,1},27,32,67},
{{1,1,1},28,31,65},
{{1,1,1},29,30,63},
{{1,1,1},30,29,61},
{{1,1,1},31,26,59},
{{1,1,1},32,25,58},
{{1,1,1},33,25,56},
{{1,1,1},34,24,55},
{{1,1,1},35,23,54},
{{1,1,1},36,22,53},
{{1,1,1},37,21,51},
{{1,1,1},38,21,50},
{{1,1,1},39,20,49},
{{1,1,1},40,19,48}
};

RQVResult test542[NUM_OF_SENSOR_CONFIGS * NUM_OF_SPEED_CONFIGS] = {
{{1,0,0},20,23,71},
{{1,0,0},21,22,67},
{{1,0,0},22,21,64},
{{1,0,0},23,20,62},
{{1,0,0},24,19,59},
{{1,0,0},25,19,57},
{{1,0,0},26,18,54},
{{1,0,0},27,17,52},
{{1,0,0},28,17,51},
{{1,0,0},29,16,49},
{{1,0,0},30,16,47},
{{1,0,0},31,15,46},
{{1,0,0},32,15,44},
{{1,0,0},33,14,43},
{{1,0,0},34,14,42},
{{1,0,0},35,13,40},
{{1,0,0},36,13,39},
{{1,0,0},37,13,38},
{{1,0,0},38,12,37},
{{1,0,0},39,12,36},
{{1,0,0},40,12,35},
{{0,1,0},20,19,50},
{{0,1,0},21,18,48},
{{0,1,0},22,17,47},
{{0,1,0},23,16,45},
{{0,1,0},24,16,44},
{{0,1,0},25,15,43},
{{0,1,0},26,14,41},
{{0,1,0},27,14,40},
{{0,1,0},28,13,39},
{{0,1,0},29,13,38},
{{0,1,0},30,12,37},
{{0,1,0},31,11,37},
{{0,1,0},32,11,36},
{{0,1,0},33,10,35},
{{0,1,0},34,10,34},
{{0,1,0},35,9,34},
{{0,1,0},36,9,33},
{{0,1,0},37,9,33},
{{0,1,0},38,9,32},
{{0,1,0},39,8,32},
{{0,1,0},40,8,31},
{{1,1,0},20,42,119},
{{1,1,0},21,40,114},
{{1,1,0},22,38,109},
{{1,1,0},23,37,105},
{{1,1,0},24,35,101},
{{1,1,0},25,34,97},
{{1,1,0},26,32,94},
{{1,1,0},27,31,91},
{{1,1,0},28,30,88},
{{1,1,0},29,29,85},
{{1,1,0},30,28,83},
{{1,1,0},31,26,80},
{{1,1,0},32,25,78},
{{1,1,0},33,24,76},
{{1,1,0},34,24,74},
{{1,1,0},35,23,72},
{{1,1,0},36,22,71},
{{1,1,0},37,21,69},
{{1,1,0},38,21,67},
{{1,1,0},39,20,66},
{{1,1,0},40,20,64},
{{0,0,1},20,10,17},
{{0,0,1},21,9,16},
{{0,0,1},22,9,16},
{{0,0,1},23,8,15},
{{0,0,1},24,8,15},
{{0,0,1},25,8,15},
{{0,0,1},26,6,15},
{{0,0,1},27,6,14},
{{0,0,1},28,6,14},
{{0,0,1},29,6,14},
{{0,0,1},30,5,14},
{{0,0,1},31,5,13},
{{0,0,1},32,5,13},
{{0,0,1},33,5,13},
{{0,0,1},34,5,13},
{{0,0,1},35,4,13},
{{0,0,1},36,4,12},
{{0,0,1},37,4,12},
{{0,0,1},38,4,12},
{{0,0,1},39,4,12},
{{0,0,1},40,4,12},
{{1,0,1},20,33,86},
{{1,0,1},21,31,82},
{{1,0,1},22,30,78},
{{1,0,1},23,29,75},
{{1,0,1},24,27,72},
{{1,0,1},25,26,69},
{{1,0,1},26,24,67},
{{1,0,1},27,23,65},
{{1,0,1},28,22,63},
{{1,0,1},29,22,61},
{{1,0,1},30,21,59},
{{1,0,1},31,20,57},
{{1,0,1},32,19,55},
{{1,0,1},33,19,54},
{{1,0,1},34,18,52},
{{1,0,1},35,18,51},
{{1,0,1},36,17,50},
{{1,0,1},37,17,49},
{{1,0,1},38,16,47},
{{1,0,1},39,16,46},
{{1,0,1},40,15,45},
{{0,1,1},20,28,65},
{{0,1,1},21,27,63},
{{0,1,1},22,26,61},
{{0,1,1},23,25,59},
{{0,1,1},24,24,57},
{{0,1,1},25,23,55},
{{0,1,1},26,21,54},
{{0,1,1},27,20,53},
{{0,1,1},28,19,51},
{{0,1,1},29,18,50},
{{0,1,1},30,18,49},
{{0,1,1},31,16,48},
{{0,1,1},32,15,47},
{{0,1,1},33,15,46},
{{0,1,1},34,14,45},
{{0,1,1},35,14,44},
{{0,1,1},36,13,44},
{{0,1,1},37,13,43},
{{0,1,1},38,12,42},
{{0,1,1},39,12,42},
{{0,1,1},40,12,41},
{{1,1,1},20,52,134},
{{1,1,1},21,49,128},
{{1,1,1},22,47,123},
{{1,1,1},23,45,118},
{{1,1,1},24,43,114},
{{1,1,1},25,41,110},
{{1,1,1},26,39,106},
{{1,1,1},27,37,103},
{{1,1,1},28,36,100},
{{1,1,1},29,34,97},
{{1,1,1},30,33,94},
{{1,1,1},31,31,92},
{{1,1,1},32,30,89},
{{1,1,1},33,29,87},
{{1,1,1},34,28,85},
{{1,1,1},35,27,83},
{{1,1,1},36,26,81},
{{1,1,1},37,25,79},
{{1,1,1},38,25,77},
{{1,1,1},39,24,76},
{{1,1,1},40,23,74}
};


void selectData(){
//445, 541, 245_1, 245_2,144

	if (avgRates[0] == 5 &amp;&amp; avgRates[1] == 4 &amp;&amp; avgRates[2] == 1)
   		RQVResultsArray = test541;
	else if (avgRates[0] == 4 &amp;&amp; avgRates[1] == 4 &amp;&amp; avgRates[2] == 5)
   		RQVResultsArray = test445;
	else if (avgRates[0] == 2 &amp;&amp; avgRates[1] == 4 &amp;&amp; avgRates[2] == 5)
   		RQVResultsArray = test245_1;
	else if (avgRates[0] == 1 &amp;&amp; avgRates[1] == 4 &amp;&amp; avgRates[2] == 4)
   		RQVResultsArray = test541;
    else if (avgRates[0] == 5 &amp;&amp; avgRates[1] == 4 &amp;&amp; avgRates[2] == 2)
        RQVResultsArray = test542;
	else 
		RQVResultsArray = test245_2;

}

// Template to fill more data
/*RQVResult array[147] = {
                              {0,0,1,20,,},{0,0,1,21,,},{0,0,1,22,,},{0,0,1,23,,},{0,0,1,24,,}, 
                              {0,0,1,25,,},{0,0,1,26,,},{0,0,1,27,,},{0,0,1,28,,},{0,0,1,29,,}, 
                              {0,0,1,30,,},{0,0,1,31,,},{0,0,1,32,,},{0,0,1,33,,},{0,0,1,34,,},
                              {0,0,1,35,,},{0,0,1,36,,},{0,0,1,37,,},{0,0,1,38,,},{0,0,1,39,,},
                              {0,0,1,40,,},

                              {0,1,0,20,,},{0,1,0,21,,},{0,1,0,22,,},{0,1,0,23,,},{0,1,0,24,,}, 
                              {0,1,0,25,,},{0,1,0,26,,},{0,1,0,27,,},{0,1,0,28,,},{0,1,0,29,,}, 
                              {0,1,0,30,,},{0,1,0,31,,},{0,1,0,32,,},{0,1,0,33,,},{0,1,0,34,,},
                              {0,1,0,35,,},{0,1,0,36,,},{0,1,0,37,,},{0,1,0,38,,},{0,1,0,39,,},
                              {0,1,0,40,,},

                              {0,1,1,20,,},{0,1,1,21,,},{0,1,1,22,,},{0,1,1,23,,},{0,1,1,24,,}, 
                              {0,1,1,25,,},{0,1,1,26,,},{0,1,1,27,,},{0,1,1,28,,},{0,1,1,29,,}, 
                              {0,1,1,30,,},{0,1,1,31,,},{0,1,1,32,,},{0,1,1,33,,},{0,1,1,34,,},
                              {0,1,1,35,,},{0,1,1,36,,},{0,1,1,37,,},{0,1,1,38,,},{0,1,1,39,,},
                              {0,1,1,40,,},

                              {1,0,0,20,,},{1,0,0,21,,},{1,0,0,22,,},{1,0,0,23,,},{1,0,0,24,,}, 
                              {1,0,0,25,,},{1,0,0,26,,},{1,0,0,27,,},{1,0,0,28,,},{1,0,0,29,,}, 
                              {1,0,0,30,,},{1,0,0,31,,},{1,0,0,32,,},{1,0,0,33,,},{1,0,0,34,,},
                              {1,0,0,35,,},{1,0,0,36,,},{1,0,0,37,,},{1,0,0,38,,},{1,0,0,39,,},
                              {1,0,0,40,,},

                              {1,0,1,20,,},{1,0,1,21,,},{1,0,1,22,,},{1,0,1,23,,},{1,0,1,24,,}, 
                              {1,0,1,25,,},{1,0,1,26,,},{1,0,1,27,,},{1,0,1,28,,},{1,0,1,29,,}, 
                              {1,0,1,30,,},{1,0,1,31,,},{1,0,1,32,,},{1,0,1,33,,},{1,0,1,34,,},
                              {1,0,1,35,,},{1,0,1,36,,},{1,0,1,37,,},{1,0,1,38,,},{1,0,1,39,,},
                              {1,0,1,40,,},

                              {1,1,0,20,,},{1,1,0,21,,},{1,1,0,22,,},{1,1,0,23,,},{1,1,0,24,,}, 
                              {1,1,0,25,,},{1,1,0,26,,},{1,1,0,27,,},{1,1,0,28,,},{1,1,0,29,,}, 
                              {1,1,0,30,,},{1,1,0,31,,},{1,1,0,32,,},{1,1,0,33,,},{1,1,0,34,,},
                              {1,1,0,35,,},{1,1,0,36,,},{1,1,0,37,,},{1,1,0,38,,},{1,1,0,39,,},
                              {1,1,0,40,,},

                              {1,1,1,20,,},{1,1,1,21,,},{1,1,1,22,,},{1,1,1,23,,},{1,1,1,24,,}, 
                              {1,1,1,25,,},{1,1,1,26,,},{1,1,1,27,,},{1,1,1,28,,},{1,1,1,29,,}, 
                              {1,1,1,30,,},{1,1,1,31,,},{1,1,1,32,,},{1,1,1,33,,},{1,1,1,34,,},
                              {1,1,1,35,,},{1,1,1,36,,},{1,1,1,37,,},{1,1,1,38,,},{1,1,1,39,,},
                              {1,1,1,40,,}
                         };
*/</declaration>
		<location id="id20" x="128" y="88">
			<urgent/>
		</location>
		<location id="id21" x="232" y="0">
			<urgent/>
		</location>
		<location id="id22" x="-32" y="0">
			<name x="-48" y="-40">Waiting</name>
		</location>
		<init ref="id22"/>
		<transition>
			<source ref="id21"/>
			<target ref="id20"/>
			<label kind="assignment" x="144" y="64">selectData()</label>
			<nail x="232" y="88"/>
		</transition>
		<transition>
			<source ref="id20"/>
			<target ref="id22"/>
			<label kind="synchronisation" x="-24" y="64">receive_probability!</label>
			<nail x="-32" y="88"/>
		</transition>
		<transition>
			<source ref="id22"/>
			<target ref="id21"/>
			<label kind="synchronisation" x="32" y="-24">calculate_probability?</label>
		</transition>
	</template>
	<template>
		<name>Planner</name>
		<declaration>int step = 0;
int sensorId;
int count = 0;
/*
void createPlan(){
    step = 0;
    if (bestConfiguration.sensor1 != currentConfiguration.sensor1){
	    bestConfiguration.sensor1 == 1 ? plans[step].planStep = ON_SENSOR : plans[step].planStep = OFF_SENSOR;
        plans[step++].data = 0;
    }
    if (bestConfiguration.sensor2 != currentConfiguration.sensor2){
	    bestConfiguration.sensor2 == 1 ? plans[step].planStep = ON_SENSOR : plans[step].planStep = OFF_SENSOR;
        plans[step++].data = 1;
    }
    if (bestConfiguration.sensor3 != currentConfiguration.sensor3){
	    bestConfiguration.sensor3 == 1 ? plans[step].planStep = ON_SENSOR : plans[step].planStep = OFF_SENSOR;
        plans[step++].data = 2;
    }
    if (bestConfiguration.speed != currentConfiguration.speed){
        plans[step].planStep = CHANGE_SPEED;
        plans[step].data = bestConfiguration.speed;    
    }

    currentConfiguration = bestConfiguration;

}
*/

const int DO_NOTHING = 1, TURN_ON = 2, TURN_OFF = 3;
bool changeSensorConfigs(){
    return bestConfiguration.sensors != currentConfiguration.sensors;
}

int checkSensorConfig(int sensorId){
    if (bestConfiguration.sensors[sensorId] == currentConfiguration.sensors[sensorId])
        return DO_NOTHING;
    else{
         return bestConfiguration.sensors[sensorId]? TURN_ON: TURN_OFF;
    }
}

void addStepOnSensor(int sensorId){
    plan.steps[count].step = ON_SENSOR;
    plan.steps[count++].data = sensorId;
}

void addStepOffSensor(int sensorId){
    plan.steps[count].step = OFF_SENSOR;
    plan.steps[count++].data = sensorId;
}

bool changeUUVSpeed(){
    return bestConfiguration.speed != currentConfiguration.speed;
}

void addStepChangeUUVSpeed(){
    plan.steps[count].step = CHANGE_SPEED;
    plan.steps[count++].data = bestConfiguration.speed;
}

void planCompleted(){
    currentConfiguration = bestConfiguration;
    plan.stepCount = count;
    count = 0;
}

</declaration>
		<location id="id23" x="102" y="306">
			<name x="42" y="272">ChangeUUVSpeed</name>
			<committed/>
		</location>
		<location id="id24" x="-68" y="306">
			<name x="-59" y="272">PlanCreated</name>
			<committed/>
		</location>
		<location id="id25" x="442" y="306">
			<name x="456" y="280">CheckUUVSpeed</name>
			<committed/>
		</location>
		<location id="id26" x="442" y="204">
			<name x="368" y="168">SensorConfigsCompleted</name>
			<committed/>
		</location>
		<location id="id27" x="510" y="68">
			<committed/>
		</location>
		<location id="id28" x="748" y="68">
			<committed/>
		</location>
		<location id="id29" x="272" y="68">
			<name x="195" y="-110">ChangeSensorsConfig</name>
			<committed/>
		</location>
		<location id="id30" x="68" y="68">
			<name x="34" y="-110">Planning</name>
			<committed/>
		</location>
		<location id="id31" x="-68" y="68" color="#00ff00">
			<name x="-85" y="-110">Wait</name>
		</location>
		<init ref="id31"/>
		<transition>
			<source ref="id23"/>
			<target ref="id24"/>
		</transition>
		<transition>
			<source ref="id24"/>
			<target ref="id31"/>
			<label kind="synchronisation" x="-59" y="195">execute!</label>
			<label kind="assignment" x="-59" y="212">planCompleted()</label>
		</transition>
		<transition>
			<source ref="id25"/>
			<target ref="id23"/>
			<label kind="guard" x="200" y="352">changeUUVSpeed()</label>
			<label kind="assignment" x="200" y="280">addStepChangeUUVSpeed()</label>
		</transition>
		<transition>
			<source ref="id25"/>
			<target ref="id24"/>
			<label kind="guard" x="200" y="264">!changeUUVSpeed()</label>
			<nail x="442" y="374"/>
			<nail x="-68" y="374"/>
		</transition>
		<transition>
			<source ref="id28"/>
			<target ref="id26"/>
			<label kind="guard" x="527" y="187">sensorId == SENSORS - 1</label>
			<nail x="782" y="102"/>
			<nail x="782" y="204"/>
		</transition>
		<transition>
			<source ref="id28"/>
			<target ref="id29"/>
			<label kind="guard" x="467" y="-110">sensorId &lt; SENSORS - 1</label>
			<label kind="assignment" x="467" y="-93">sensorId++</label>
			<nail x="782" y="34"/>
			<nail x="782" y="-68"/>
			<nail x="272" y="-68"/>
		</transition>
		<transition>
			<source ref="id27"/>
			<target ref="id28"/>
			<label kind="guard" x="527" y="119">step == DO_NOTHING</label>
			<nail x="510" y="136"/>
			<nail x="748" y="136"/>
		</transition>
		<transition>
			<source ref="id27"/>
			<target ref="id28"/>
			<label kind="guard" x="527" y="25">step == TURN_OFF</label>
			<label kind="assignment" x="527" y="42">addStepOffSensor(sensorId)</label>
		</transition>
		<transition>
			<source ref="id27"/>
			<target ref="id28"/>
			<label kind="guard" x="527" y="-42">step == TURN_ON</label>
			<label kind="assignment" x="527" y="-25">addStepOnSensor(sensorId)</label>
			<nail x="510" y="0"/>
			<nail x="748" y="0"/>
		</transition>
		<transition>
			<source ref="id29"/>
			<target ref="id27"/>
			<label kind="assignment" x="289" y="25">step = 
checkSensorConfig(sensorId)</label>
		</transition>
		<transition>
			<source ref="id30"/>
			<target ref="id26"/>
			<label kind="guard" x="85" y="178">!changeSensorConfigs()</label>
			<nail x="68" y="204"/>
		</transition>
		<transition>
			<source ref="id26"/>
			<target ref="id25"/>
		</transition>
		<transition>
			<source ref="id30"/>
			<target ref="id29"/>
			<label kind="guard" x="85" y="25">changeSensorConfigs()</label>
			<label kind="assignment" x="85" y="42">sensorId=0</label>
		</transition>
		<transition>
			<source ref="id31"/>
			<target ref="id30"/>
			<label kind="synchronisation" x="-34" y="43">planning?</label>
		</transition>
	</template>
	<template>
		<name>Executor</name>
		<declaration>int planStep;
int data;
int index;

int nextPlanStep(){
    int step;
	step = plan.steps[index].step;
    plan.steps[index].step = 0;
    return step;
}

int nextPlanData(){
    int data;
	data = plan.steps[index].data;
    plan.steps[index].data = 0;
    return data;
}

void startExecutingPlan(){
	index = 0;
	data = 0;
}

bool allPlanStepsExecutedF(){
	return index == plan.stepCount;
}</declaration>
		<location id="id32" x="384" y="-48">
			<name x="344" y="-96">ChangeSpeed</name>
			<committed/>
		</location>
		<location id="id33" x="384" y="-112">
			<name x="336" y="-160">OffSensor</name>
			<committed/>
		</location>
		<location id="id34" x="384" y="-184">
			<name x="336" y="-232">OnSensor</name>
			<committed/>
		</location>
		<location id="id35" x="160" y="-112">
			<name x="168" y="-168">ExecutePlanStep</name>
			<committed/>
		</location>
		<location id="id36" x="160" y="-240">
			<name x="120" y="-288">PlanExecuted</name>
			<committed/>
		</location>
		<location id="id37" x="536" y="-112">
			<name x="432" y="-288">PlanStepExecuted</name>
			<committed/>
		</location>
		<location id="id38" x="-80" y="-112">
			<name x="-64" y="-144">StartExecution</name>
			<committed/>
		</location>
		<location id="id39" x="-80" y="-240">
			<name x="-104" y="-288">Waiting</name>
		</location>
		<init ref="id39"/>
		<transition>
			<source ref="id32"/>
			<target ref="id37"/>
			<label kind="synchronisation" x="400" y="-40">changeSpeed!</label>
			<label kind="assignment" x="400" y="-24">newSpeed = data</label>
			<nail x="480" y="-48"/>
		</transition>
		<transition>
			<source ref="id33"/>
			<target ref="id37"/>
			<label kind="synchronisation" x="408" y="-152">offSensor!</label>
			<label kind="assignment" x="408" y="-136">sensorId = data</label>
		</transition>
		<transition>
			<source ref="id34"/>
			<target ref="id37"/>
			<label kind="synchronisation" x="408" y="-224">onSensor!</label>
			<label kind="assignment" x="408" y="-208">sensorId = data</label>
			<nail x="488" y="-184"/>
		</transition>
		<transition>
			<source ref="id35"/>
			<target ref="id32"/>
			<label kind="guard" x="168" y="-72">planStep == CHANGE_SPEED</label>
			<nail x="160" y="-48"/>
		</transition>
		<transition>
			<source ref="id35"/>
			<target ref="id34"/>
			<label kind="guard" x="176" y="-208">planStep == ON_SENSOR</label>
			<nail x="160" y="-184"/>
		</transition>
		<transition>
			<source ref="id35"/>
			<target ref="id33"/>
			<label kind="guard" x="176" y="-136">planStep == OFF_SENSOR</label>
		</transition>
		<transition>
			<source ref="id36"/>
			<target ref="id39"/>
			<label kind="synchronisation" x="-24" y="-264">allPlanStepsExecuted!</label>
		</transition>
		<transition>
			<source ref="id37"/>
			<target ref="id38"/>
			<label kind="guard" x="112" y="-24">!allPlanStepsExecutedF()</label>
			<nail x="536" y="0"/>
			<nail x="-80" y="0"/>
		</transition>
		<transition>
			<source ref="id37"/>
			<target ref="id36"/>
			<label kind="guard" x="256" y="-264">allPlanStepsExecutedF()</label>
			<nail x="536" y="-240"/>
		</transition>
		<transition>
			<source ref="id38"/>
			<target ref="id35"/>
			<label kind="assignment" x="-48" y="-112">planStep = nextPlanStep(),
data = nextPlanData(),
index++</label>
		</transition>
		<transition>
			<source ref="id39"/>
			<target ref="id38"/>
			<label kind="synchronisation" x="-64" y="-208">execute?</label>
			<label kind="assignment" x="-64" y="-192">startExecutingPlan()</label>
		</transition>
	</template>
	<system>// Place template instantiations here

// List one or more processes to be composed into a system.
//system UUV, Sensor, Probe, Effector, Monitor, Analyzer, Planner, RQV, Executor;
system Monitor, Analyzer, Planner, Executor;//, Probe, RQV, Effector;</system>
</nta>
